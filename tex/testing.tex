
\chapter{Testing}

The Just\cite{just} test library was used to write automated unit and
integration tests.

%TODO

\section{Test plan}

%TODO

\section{Unit and integration tests}

143 unit and integration tests were written. Both types of tests uses the Just
test library and are compiled into the same test executable:
\verb$bin/test/metashell_test$

Here is a list of these tests, with short descriptions:

\begin{description}
    \item[\texttt{test\_mdb\_step\_without\_evaluation}:]
        Tests if the step command prints
        \texttt{"Metaprogram not evaluated yet"} when no metaprogram has been
        evalutated.
    \item[\texttt{test\_mdb\_step\_fibonacci}:]
    \item[\texttt{test\_mdb\_step\_2\_fibonacci}:]
    \item[\texttt{test\_mdb\_step\_fibonacci\_twice}:]
    \item[\texttt{test\_mdb\_step\_fibonacci\_twice\_with\_empty\_second\_line}:]
    \item[\texttt{test\_mdb\_step\_fibonacci\_twice\_with\_space\_second\_line}:]
    \item[\texttt{test\_mdb\_step\_0\_fibonacci\_at\_start}:]
    \item[\texttt{test\_mdb\_step\_0\_fibonacci\_after\_step}:]
    \item[\texttt{test\_mdb\_step\_over\_the\_whole\_metaprogram\_one\_step}:]
    \item[\texttt{test\_mdb\_step\_int\_non\_template\_type}:]
    \item[\texttt{test\_mdb\_step\_over\_the\_whole\_metaprogram\_multiple\_steps}:]
    \item[\texttt{test\_mdb\_step\_over\_the\_whole\_metaprogram\_multiple\_steps\_full\_mode}:]
    \item[\texttt{test\_mdb\_step\_minus\_1\_at\_start}:]
    \item[\texttt{test\_mdb\_step\_minus\_1\_after\_step}:]
    \item[\texttt{test\_mdb\_step\_minus\_1\_after\_step\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_step\_0\_at\_start}:]
    \item[\texttt{test\_mdb\_step\_0\_at\_end}:]
    \item[\texttt{test\_mdb\_step\_minus\_1\_after\_step\_2}:]
    \item[\texttt{test\_mdb\_step\_minus\_1\_after\_step\_2\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_step\_over\_fib\_from\_root}:]
    \item[\texttt{test\_mdb\_step\_over\_fib\_from\_after\_step}:]
    \item[\texttt{test\_mdb\_step\_over\_minus\_1\_fib\_from\_after\_step}:]
    \item[\texttt{test\_mdb\_step\_over\_minus\_1\_multi\_fib\_from\_after\_step}:]
    \item[\texttt{test\_mdb\_step\_over\_template\_spec\_no\_deduced\_event}:]
    \item[\texttt{test\_mdb\_step\_garbage\_argument}:]
        Tests if the step command prints
        \texttt{"Argument parsing failed"} when it is called with a invalid
        arguments.
    \item[\texttt{test\_mdb\_command\_repeatable\_constructor\_test}:]
    \item[\texttt{test\_mdb\_command\_non\_repeatable\_constructor\_test}:]
    \item[\texttt{test\_mdb\_command\_multiple\_keys\_constructor\_test}:]
    \item[\texttt{test\_mdb\_command\_full\_description\_empty\_long\_description}:]
    \item[\texttt{test\_mdb\_command\_full\_description\_non\_empty\_long\_description}:]
    \item[\texttt{test\_templight\_xml\_parse\_empty}:]
    \item[\texttt{test\_templight\_xml\_parse\_one\_node\_with\_different\_kinds}:]
    \item[\texttt{test\_templight\_xml\_parse\_one\_node\_with\_different\_types}:]
    \item[\texttt{test\_templight\_xml\_parse\_two\_nested\_node}:]
    \item[\texttt{test\_templight\_xml\_parse\_two\_sequential\_node}:]
    \item[\texttt{test\_templight\_xml\_parse\_starting\_with\_template\_end}:]
    \item[\texttt{test\_templight\_xml\_parse\_without\_template\_end}:]
    \item[\texttt{test\_templight\_xml\_parse\_missing\_pipe\_in\_file\_location\_1}:]
    \item[\texttt{test\_templight\_xml\_parse\_missing\_pipe\_in\_file\_location\_2}:]
    \item[\texttt{test\_templight\_xml\_parse\_unknown\_kind}:]
    \item[\texttt{test\_mdb\_shell\_is\_stopped\_false\_by\_default}:]
        Tests wheter the \texttt{mdb\_shell::stopped()} returns \texttt{false}
        right after construcion.
    \item[\texttt{test\_mdb\_shell\_empty\_lines}:]
    \item[\texttt{test\_mdb\_shell\_identical\_lines\_in\_history}:]
    \item[\texttt{test\_mdb\_shell\_identical\_all\_space\_lines\_in\_history}:]
    \item[\texttt{test\_mdb\_shell\_skips\_empty\_lines}:]
    \item[\texttt{test\_mdb\_shell\_prompt}:]
        Tests wheter \texttt{mdb\_shell::prompt()} returns \texttt{"(mdb) "}.
    \item[\texttt{test\_mdb\_forwardtrace\_without\_evaluation}:]
        Tests if the forwardtrace command prints
        \texttt{"Metaprogram not evaluated yet"} when no metaprogram has been
        evalutated.
    \item[\texttt{test\_mdb\_forwardtrace\_garbage\_argument}:]
        Tests if the forwardtrace command prints
        \texttt{"Argument parsing failed"} when it is called with a invalid
        arguments.
    \item[\texttt{test\_mdb\_forwardtrace\_int}:]
    \item[\texttt{test\_mdb\_forwardtrace\_int\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_forwardtrace\_when\_metaprogram\_finished}:]
    \item[\texttt{test\_mdb\_forwardtrace\_when\_metaprogram\_finished\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_forwardtrace\_int\_with\_ft}:]
    \item[\texttt{test\_mdb\_forwardtrace\_from\_root}:]
    \item[\texttt{test\_mdb\_forwardtrace\_from\_root\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_forwardtrace\_from\_memoization}:]
    \item[\texttt{test\_mdb\_forwardtrace\_ft\_from\_step\_1}:]
    \item[\texttt{test\_mdb\_forwardtrace\_ft\_from\_step\_1\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_forwardtrace\_ft\_from\_step\_1\_with\_limit\_0}:]
    \item[\texttt{test\_mdb\_forwardtrace\_ft\_from\_step\_1\_with\_limit\_1}:]
    \item[\texttt{test\_mdb\_forwardtrace\_ft\_from\_step\_1\_with\_limit\_1\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_forwardtrace\_ft\_from\_step\_2\_with\_limit\_2}:]
    \item[\texttt{test\_mdb\_forwardtrace\_ft\_from\_step\_2\_with\_limit\_100}:]
    \item[\texttt{test\_mdb\_forwardtrace\_from\_root\_on\_narrow\_terminal}:]
        Test forwardtrace output on a narrow terminal. Wrapping should occur
        at the terminal boundary.
    \item[\texttt{test\_mdb\_forwardtrace\_on\_extremely\_narrow\_terminal\_w0}:]
        Test forwardtrace output on a zero character wide terminal.
    \item[\texttt{test\_mdb\_forwardtrace\_on\_extremely\_narrow\_terminal\_w1}:]
        Test forwardtrace output on a one character wide terminal.
    \item[\texttt{test\_mdb\_command\_handler\_map\_command\_selection\_1..8}:]
        Eight test cases, which test the command selection algorithm.
        (\texttt{mdb\_command\_handler\_map::get\_command\_from\_map()})
        Various command maps are constructed and queried. All normal and
        special cases are handled.
    \item[\texttt{test\_mdb\_command\_handler\_map\_argument\_passing}:]
        Tests if the
        \texttt{mdb\_command\_handler\_map::get\_command\_from\_map()}
        function returns the remaining argument string for the command
        correctly.
    \item[\texttt{test\_instantiation\_kind\_print}:]
        Tests the \texttt{to\_string(instantiation\_kind)} for all possible
        input values.
    \item[\texttt{test\_is\_template\_type\_primitive\_types}:]
    \item[\texttt{test\_is\_template\_type\_array\_type\_of\_non\_template\_types}:]
    \item[\texttt{test\_is\_template\_type\_pointer\_to\_non\_template\_types}:]
    \item[\texttt{test\_is\_template\_type\_templates}:]
    \item[\texttt{test\_is\_template\_type\_char\_literals}:]
    \item[\texttt{test\_mdb\_continue\_without\_evaluation}:]
        Tests if the continue command prints
        \texttt{"Metaprogram not evaluated yet"} when no metaprogram has been
        evalutated.
    \item[\texttt{test\_mdb\_continue\_garbage\_argument}:]
        Tests if the continue command prints
        \texttt{"Argument parsing failed"} when it is called with a invalid
        arguments.
    \item[\texttt{test\_mdb\_continue\_fibonacci\_no\_breakpoint}:]
    \item[\texttt{test\_mdb\_continue\_fibonacci\_reevaulation\_removes\_breakpoints}:]
    \item[\texttt{test\_mdb\_continue\_fibonacci\_1\_breakpoint}:]
    \item[\texttt{test\_mdb\_continue\_2\_fibonacci\_1\_breakpoint}:]
    \item[\texttt{test\_mdb\_continue\_twice\_fibonacci\_1\_breakpoint}:]
    \item[\texttt{test\_mdb\_continue\_fibonacci\_2\_breakpoints}:]
    \item[\texttt{test\_mdb\_continue\_2\_fibonacci\_2\_breakpoints}:]
    \item[\texttt{test\_mdb\_continue\_10\_fibonacci\_2\_breakpoints}:]
    \item[\texttt{test\_mdb\_continue\_0\_fibonacci\_1\_breakpoint}:]
    \item[\texttt{test\_mdb\_continue\_minus\_1\_at\_start}:]
    \item[\texttt{test\_mdb\_continue\_minus\_2\_at\_start}:]
    \item[\texttt{test\_mdb\_continue\_minus\_1\_with\_preceding\_breakpoint}:]
    \item[\texttt{test\_mdb\_continue\_minus\_1\_without\_preceding\_breakpoint}:]
    \item[\texttt{test\_mdb\_continue\_to\_end\_and\_back\_to\_start}:]
    \item[\texttt{test\_mdb\_continue\_to\_end\_and\_back\_to\_start\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_continue\_to\_one\_before\_end\_and\_back\_to\_start\_in\_full\_mode}:]
    \item[\texttt{test\_empty\_file\_location}:]
    \item[\texttt{test\_file\_location\_construction}:]
    \item[\texttt{test\_file\_location\_equality}:]
    \item[\texttt{test\_mdb\_rbreak\_without\_evaluated\_metaprogram}:]
        Tests if the rbreak command prints
        \texttt{"Metaprogram not evaluated yet"} when no metaprogram has been
        evalutated.
    \item[\texttt{test\_mdb\_rbreak\_with\_no\_arguments}:]
        Tests if the rbreak command prints
        \texttt{"Argument expected"} when no argument is given.
    \item[\texttt{test\_mdb\_rbreak\_with\_no\_arguments\_with\_trailing\_whitespace}:]
        Tests if the rbreak command prints
        \texttt{"Argument expected"} when no argument is given but there are
        trailing whitespaces.
    \item[\texttt{test\_mdb\_rbreak\_with\_invalid\_regex}:]
        Tests if the rbreak command prints
        \texttt{"<regex> is not a valid regex"}, where <regex> is the entered
        regular expression, when it has some syntatical error.
    \item[\texttt{test\_mdb\_rbreak\_with\_valid\_regex\_no\_match}:]
    \item[\texttt{test\_mdb\_rbreak\_with\_valid\_regex\_with\_one\_match}:]
    \item[\texttt{test\_mdb\_rbreak\_with\_valid\_regex\_with\_two\_matches}:]
    \item[\texttt{test\_mdb\_rbreak\_does\_not\_count\_stops\_in\_unreachable\_subgraphs}:]
    \item[\texttt{test\_mdb\_rbreak\_with\_valid\_regex\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_rbreak\_with\_valid\_regex\_in\_full\_mode\_match\_only\_root}:]
    \item[\texttt{test\_mdb\_rbreak\_with\_valid\_regex\_in\_full\_mode\_match\_also\_root}:]
    \item[\texttt{test\_metaprogram\_constuctor}:]
    \item[\texttt{test\_metaprogram\_with\_single\_vertex}:]
    \item[\texttt{test\_metaprogram\_with\_single\_vertex\_parallel\_edge}:]
    \item[\texttt{test\_metaprogram\_step\_back\_with\_single\_vertex}:]
    \item[\texttt{test\_metaprogram\_step\_back\_with\_single\_vertex\_parallel\_edge}:]
    \item[\texttt{test\_metaprogram\_constuctor\_full\_mode\_true}:]
    \item[\texttt{test\_metaprogram\_constuctor\_full\_mode\_false}:]
    \item[\texttt{test\_mdb\_backtrace\_without\_evaluation}:]
        Tests if the backtrace command prints
        \texttt{"Metaprogram not evaluated yet"} when no metaprogram has been
        evalutated.
    \item[\texttt{test\_mdb\_backtrace\_unstepped\_fibonacci}:]
    \item[\texttt{test\_mdb\_backtrace\_when\_metaprogram\_finished}:]
    \item[\texttt{test\_mdb\_backtrace\_when\_metaprogram\_finished\_in\_full\_mode}:]
    \item[\texttt{test\_mdb\_backtrace\_1\_stepped\_fibonacci}:]
    \item[\texttt{test\_mdb\_backtrace\_2\_stepped\_fibonacci}:]
    \item[\texttt{test\_mdb\_backtrace\_3\_stepped\_fibonacci}:]
    \item[\texttt{test\_mdb\_backtrace\_garbage\_argument}:]
        Tests if the backtrace command prints
        \texttt{"Argument parsing failed"} when it is called with a invalid
        arguments.
    \item[\texttt{test\_mdb\_backtrace\_bt\_alias}:]
        Tests if the \texttt{"bt"} alias of the backtrace command is
        accepcted.
    \item[\texttt{test\_mdb\_evaluate\_int}:]
    \item[\texttt{test\_mdb\_evaluate\_fib\_10}:]
    \item[\texttt{test\_mdb\_evaluate\_no\_arguments\_no\_evaluation}:]
        Tests if the evaluate command prints
        \texttt{"Nothing has been evaluated yet."} when no metaprogram has been
        evaluated and it is called with no arguments.
    \item[\texttt{test\_mdb\_evaluate\_no\_arguments\_with\_trailing\_spaces\_no\_evaluation}:]
        Tests if the evaluate command prints
        \texttt{"Nothing has been evaluated yet."} when no metaprogram has been
        evaluated and it is called with no arguments, but with trailing
        whitespaces.
    \item[\texttt{test\_mdb\_evaluate\_failure\_will\_reset\_metaprogram\_state}:]
    \item[\texttt{test\_mdb\_evaluate\_missing\_argument\_will\_run\_last\_metaprogram}:]
    \item[\texttt{test\_mdb\_evaluate\_missing\_argument\_will\_reset\_metaprogram\_state}:]
    \item[\texttt{test\_mdb\_evaluate\_filters\_similar\_edges}:]
    \item[\texttt{test\_mdb\_evaluate\_clears\_breakpoints}:]
    \item[\texttt{test\_mdb\_evaluate\_reevaluate\_clears\_breakpoints}:]
    \item[\texttt{test\_mdb\_evaluate\_failure\_clears\_breakpoints}:]
    \item[\texttt{test\_readme\_continue\_abbreviated\_as\_c}:]
    \item[\texttt{test\_readme\_getting\_started}:]
        Tests the procedure described in the Getting Started section of the
        README.md file.
    \item[\texttt{test\_readme\_how\_to\_template\_argument\_deduction}:]
        Tests the procedure described in the How to see what happens during
        template argument deduction section of the README.md file.
\end{description}

